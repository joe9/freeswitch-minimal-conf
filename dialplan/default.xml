<include>
<!--
    NOTICE:

    This context is usually accessed via authenticated callers on the sip profile on port 5060
    or transfered callers from the public context which arrived via the sip profile on port 5080.

    Authenticated users will use the user_context variable on the user to determine what context
    they can access.  You can also add a user in the directory with the cidr= attribute acl.conf.xml
    will build the domains ACL using this value.
-->
<!-- http://wiki.freeswitch.org/wiki/Dialplan_XML -->
<!-- for outbound conections -->
  <context name="default">

        <!-- This extension simply prints out the channel variables that you may   -->
        <!-- use to determine what action to take. Use this for debugging your     -->
        <!-- dialplan and comment it out once things are set the way you want them -->
        <!-- The continue=true parameter causes Freeswitch to continue processing  -->
        <!-- other dialplan conditions even though this one was a match            -->
        <extension name="PrintVars" continue="true">
            <condition field="destination_number" expression="^[0-9]">
            <action application="info"/>
            </condition>
        </extension>

        <extension name="emergency.circlenet">
            <condition field="${toll_allow}" expression="local"/>
            <condition field="destination_number" expression="^911$">
            <action application="set" data="hangup_after_bridge=true"/>
            <action application="set" data="effective_caller_id_number=$${circlenet_did}"/>
            <action application="bridge" data="sofia/gateway/circlenet/911"/>
            </condition>
        </extension>

        <extension name="information.circlenet">
            <condition field="${toll_allow}" expression="local"/>
            <condition field="destination_number" expression="^411$">
            <action application="set" data="hangup_after_bridge=true"/>
            <action application="set" data="effective_caller_id_number=${outbound_caller_id_number}"/>
            <action application="set" data="effective_caller_id_name=${outbound_caller_id_name}"/>
            <action application="bridge" data="sofia/gateway/circlenet/411"/>
            </condition>
        </extension>

        <extension name="local.circlenet">
            <condition field="${toll_allow}" expression="local"/>
            <condition field="destination_number" expression="^(\d{7})$">
            <action application="set" data="hangup_after_bridge=true"/>
            <action application="set" data="effective_caller_id_number=${outbound_caller_id_number}"/>
            <action application="set" data="effective_caller_id_name=${outbound_caller_id_name}"/>
            <action application="bridge" data="sofia/gateway/circlenet/1$${circlenet_did_areacode}$1"/>
            </condition>
        </extension>

        <extension name="domestic.circlenet">
            <condition field="${toll_allow}" expression="domestic"/>
            <condition field="destination_number" expression="^(1?\d{10})$">
            <action application="set" data="effective_caller_id_number=${outbound_caller_id_number}"/>
            <action application="set" data="effective_caller_id_name=${outbound_caller_id_name}"/>
            <action application="bridge" data="sofia/gateway/circlenet/$1"/>
            </condition>
        </extension>

        <extension name="international.circlenet">
            <condition field="${toll_allow}" expression="international"/>
            <condition field="destination_number" expression="^(011\d+)$">
            <action application="set" data="effective_caller_id_number=${outbound_caller_id_number}"/>
            <action application="set" data="effective_caller_id_name=${outbound_caller_id_name}"/>
            <action application="bridge" data="sofia/gateway/circlenet/$1"/>
            </condition>
        </extension>

  </context>
</include>


